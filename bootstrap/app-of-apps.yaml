apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: root-app-of-apps
  namespace: openshift-gitops # This application CRD itself lives in the ArgoCD namespace
spec:
  project: default # Or your specific ArgoCD project

  source:
    repoURL: https://github.com/cnuland/hello-chris-rag-pipeline.git # CHANGEME: URL to your Git repository
    path: bootstrap/ # Path to the directory containing the kustomization.yaml for child apps
    targetRevision: HEAD # CHANGEME: Your target branch, tag, or commit
    # kustomize: {} # Implicit if kustomization.yaml exists in the path

  destination:
    # The child Application CRDs will be created in this namespace.
    # This should be the namespace where ArgoCD runs and manages its own configuration, typically 'argocd'.
    server: https://kubernetes.default.svc
    namespace: openshift-gitops # CHANGEME if your ArgoCD runs in a different namespace

  syncPolicy:
    automated:
      prune: true    # Allows ArgoCD to delete child Applications if they are removed from Git
      selfHeal: true # Allows ArgoCD to correct deviations from the Git state
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
      # Typically, the 'argocd' namespace already exists.
                              # Set to true if this root app should try to create the 'argocd' namespace.